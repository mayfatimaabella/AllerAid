<div class="emergency-settings-title">Emergency Settings</div>

<div class="emergency-setting-card">
  <div class="emergency-setting-info">
    <div class="emergency-setting-title">Shake to Alert</div>
    <div class="emergency-setting-desc">Shake phone to trigger emergency</div>
  </div>
  <ion-toggle [(ngModel)]="emergencySettings.shakeToAlert" (ionChange)="saveEmergencySettings()"></ion-toggle>
</div>

<div class="emergency-setting-card">
  <div class="emergency-setting-info">
    <div class="emergency-setting-title">Power Button Alert</div>
    <div class="emergency-setting-desc">Press power button 3 times</div>
  </div>
  <ion-toggle [(ngModel)]="emergencySettings.powerButtonAlert" (ionChange)="saveEmergencySettings()"></ion-toggle>
</div>

<div class="emergency-setting-card">
  <div class="emergency-setting-info">
    <div class="emergency-setting-title">Audio Instructions</div>
    <div class="emergency-setting-desc">Play emergency message aloud</div>
    <div class="emergency-setting-status" *ngIf="emergencySettings.audioInstructions">
      <span [class]="getAudioSourceClass()">{{ getAudioSourceText() }}</span>
    </div>
  </div>
  <div class="emergency-setting-actions">
    <ion-button *ngIf="emergencySettings.audioInstructions" 
                (click)="openVoiceRecordingModal()" 
                fill="clear" 
                size="small"
                [color]="showVoiceSettings ? 'primary' : 'medium'">
      <ion-icon name="mic-outline" slot="icon-only"></ion-icon>
    </ion-button>
    <ion-toggle [(ngModel)]="emergencySettings.audioInstructions" (ionChange)="saveEmergencySettings()"></ion-toggle>
  </div>
  <!-- Add Emergency Instructions Button (if instructions are empty) -->
  <div style="margin-top:12px; text-align:center;" *ngIf="isEmergencyInstructionsEmpty()">
    <ion-button size="default" fill="solid" color="primary" (click)="openEditEmergencyMessageModal()">
      <ion-icon name="add-outline" slot="start"></ion-icon>
      Add Emergency Instructions
    </ion-button>
  </div>
</div>

<ng-content select=".emergency-instructions-display"></ng-content>

<div class="emergency-testing-title">Emergency Alert Testing</div>

<div class="emergency-test-buttons">
  <ion-button expand="block" fill="outline" color="warning" (click)="testEmergencyAlert()">
    <ion-icon name="warning-outline" slot="start"></ion-icon>
    Test Emergency Alert (Manual)
  </ion-button>

  <ion-button expand="block" fill="outline" color="primary" (click)="testShakeDetection()">
    <ion-icon name="phone-portrait-outline" slot="start"></ion-icon>
    Test Shake Detection
  </ion-button>

  <ion-button expand="block" fill="outline" color="secondary" (click)="testPowerButtonDetection()">
    <ion-icon name="power-outline" slot="start"></ion-icon>
    Test Power Button Detection
  </ion-button>

  <ion-button expand="block" fill="outline" color="tertiary" (click)="testAudioInstructions()">
    <ion-icon name="volume-high-outline" slot="start"></ion-icon>
    Test Audio Instructions
  </ion-button>

  <ion-button expand="block" fill="outline" color="medium" (click)="requestMotionPermissions()">
    <ion-icon name="checkmark-circle-outline" slot="start"></ion-icon>
    Request Motion Permissions
  </ion-button>

  <ion-button expand="block" fill="outline" color="success" (click)="showEmergencyExamples()">
    <ion-icon name="book-outline" slot="start"></ion-icon>
    View Examples & Tips
  </ion-button>
</div>

