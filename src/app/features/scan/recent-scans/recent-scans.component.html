<ion-modal 
  #modal
  [isOpen]="isOpen"
  [swipeToClose]="true"
  [breakpoints]="[0, 0.5, 1]"
  [initialBreakpoint]="0.9"
  [handleBehavior]="'cycle'"
  (ionModalDidDismiss)="onDismiss()">

  <ng-template>

    <!-- Header -->
    <ion-header collapse="condense">
      <ion-toolbar>
        <div class="modal-drag-handle"></div>
      </ion-toolbar>
    </ion-header>

    <ion-content [fullscreen]="true">

      <ion-header collapse="condense">
        <ion-toolbar>
          <ion-title size="large">Recent Scans</ion-title>
        </ion-toolbar>
      </ion-header>

      <div class="scans-container ion-padding">

        <!-- LIST -->
        <ion-list *ngIf="recentScans.length > 0">

          <ion-item
            *ngFor="let scan of recentScans; let i = index"
            button
            detail="true"
            (click)="onScanSelected(scan)"
            class="scan-item">

            <!-- Thumbnail -->
            <ion-thumbnail slot="start">
              <img [src]="scan.image_url || 'assets/img/placeholder.png'" alt="Product Image">
            </ion-thumbnail>

            <!-- Product Info -->
            <ion-label>
              <h2>{{ scan.product_name }}</h2>
              <p>{{ scan.brand }}</p>
              <small>{{ scan.date | date:'short' }}</small>
            </ion-label>

            <!-- Status Badge -->
            <ion-badge 
              [color]="scan.status === 'safe' ? 'success' : 'danger'">
              {{ scan.status | uppercase }}
            </ion-badge>

            <!-- Delete Button -->
            <ion-button
              fill="clear"
              color="danger"
              slot="end"
              (click)="onDeleteScan(i, $event)">

              <ion-icon name="trash-outline"></ion-icon>
            </ion-button>

          </ion-item>

        </ion-list>

        <!-- CLEAR ALL BUTTON -->
        <ion-button
          *ngIf="recentScans.length > 0"
          expand="block"
          color="danger"
          class="ion-margin-top"
          (click)="onClearScans()">

          <ion-icon name="trash-outline" slot="start"></ion-icon>
          Clear Recent Scans
        </ion-button>

        <!-- EMPTY STATE -->
        <div *ngIf="recentScans.length === 0" class="empty-state ion-text-center">
          <ion-icon name="time-outline" style="font-size: 48px;"></ion-icon>
          <p>No recent scans yet</p>
        </div>

      </div>

    </ion-content>

  </ng-template>
</ion-modal>
